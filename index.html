<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>TWA Sample App</title>
    <style>
        body {
            --bg-color: var(--tg-theme-bg-color);
            font: 12px/18px "Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--tg-theme-text-color);
            margin: 24px;
            padding: 0;
            color-scheme: var(--tg-color-scheme);
        }
        body.tg-grey {
            background-color: var(--tg-theme-secondary-bg-color);
        }

        a {
            color: var(--tg-theme-link-color);
        }
        .viewport {
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            height: var(--tg-viewport-stable-height, 100vh);
            pointer-events: none;
        }
        .viewport:before {
            content: attr(text);
            display: inline-block;
            position: absolute;
            background: var(--tg-theme-link-color);
            right: auto;
            left: 4px;
            top: 2px;
            font-size: 8px;
            padding: 4px;
            vertical-align: top;
        }
        .viewport:after {
            content: '';
            display: block;
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            border-width: 4px;
            border-style: solid;
            border-image: linear-gradient(45deg, rgba(64, 224, 208, .5), rgba(173, 255, 47, .5)) 1;
        }
    </style>
</head>

<body>
    <main>
        <h1>Modal windows</h1>
        <ul>
            <li><a href="javascript:;" onclick="DemoApp.showAlert('Hello World!');">showAlert</a></li>
            <li><a href="javascript:;" onclick="DemoApp.showPopup();">showPopup</a></li>
        </ul>

        <h1>Links</h1>
        <ul>
            <li>
                <a href="javascript:Telegram.WebApp.openTelegramLink('https://t.me/trendingapps');">Open link within Telegram</a>
            </li>
            <li>
                <a href="javascript:Telegram.WebApp.openLink('https://ton.org/');">Open link in external browser</a>
            </li>
            <li>
                <a href="javascript:Telegram.WebApp.openLink('https://telegra.ph/api',{try_instant_view:true});">Open link inside Telegram webview</a>
            </li>
        </ul>

        <h1>Buttons</h1>
        <button onclick="DemoApp.expand();">Expand Webview</button>
        <button onclick="DemoApp.toggleMainButton(this);">Hide Main Button</button>
    </main>
    <div class="viewport"></div>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        Telegram.WebApp.onEvent('themeChanged', function() {
            document.documentElement.className = Telegram.WebApp.colorScheme;
        });

        Telegram.WebApp.ready();

        const DemoApp = {
            initData: Telegram.WebApp.initData || '',
            initDataUnsafe: Telegram.WebApp.initDataUnsafe || {},
            MainButton: Telegram.WebApp.MainButton,

            init(options) {
                document.body.style.visibility = '';
                Telegram.WebApp.ready();
                Telegram.WebApp.MainButton.setParams({
                    text: 'CLOSE WEBVIEW',
                    is_visible: true
                }).onClick(DemoApp.close);
            },
            expand() {
                Telegram.WebApp.expand();
            },
            close() {
                Telegram.WebApp.close();
            },
            toggleMainButton(el) {
                const mainButton = Telegram.WebApp.MainButton;
                if (mainButton.isVisible) {
                    mainButton.hide();
                    el.innerHTML = 'Show Main Button';
                } else {
                    mainButton.show();
                    el.innerHTML = 'Hide Main Button';
                }
            },

            

            // Alerts
            showAlert(message) {
                Telegram.WebApp.showAlert(message);
            },
            showConfirm(message) {
                Telegram.WebApp.showConfirm(message);
            },
            showPopup() {
                Telegram.WebApp.showPopup({
                    title: 'Popup title',
                    message: 'Popup message',
                    buttons: [
                        {id: 'delete', type: 'destructive', text: 'Delete all'},
                        {id: 'faq', type: 'default', text: 'Open FAQ'},
                        {type: 'cancel'},
                    ]
                }, function(buttonId) {
                    if (buttonId === 'delete') {
                        DemoApp.showAlert("'Delete all' selected");
                    } else if (buttonId === 'faq') {
                        Telegram.WebApp.openLink('https://telegram.org/faq');
                    }
                });
            },
        }

        const DemoAppMenu = {
            init() {
                DemoApp.init();
                document.body.classList.add('gray');
                Telegram.WebApp.setHeaderColor('secondary_bg_color');
            }
        };

        function round(val, d) {
            const k = Math.pow(10, d || 0);
            return Math.round(val * k) / k;
        }

        function setViewportData() {
            document.querySelector('.viewport')
                .setAttribute('text', window.innerWidth + ' x ' + Telegram.WebApp.viewportStableHeight +
                    ' | is_expanded: ' + (Telegram.WebApp.isExpanded ? 'true' : 'false'));
        }
        Telegram.WebApp.setHeaderColor('secondary_bg_color');
        Telegram.WebApp.onEvent('viewportChanged', setViewportData);
        setViewportData();

        Telegram.WebApp.onEvent('themeChanged', function() {
            bgColorInput.value = Telegram.WebApp.backgroundColor;
            document.body.setAttribute('style', '--bg-color:' + Telegram.WebApp.backgroundColor);
        });

    </script>

</body>
</html>
